; =============================================================================
; PJSIP Configuration for DIDWW Voice OTP Gateway
; Generated from template - DO NOT EDIT DIRECTLY
; =============================================================================
; Note: DIDWW outbound trunks do NOT require SIP registration.
; Authentication is done via digest auth on INVITE requests.

; -----------------------------------------------------------------------------
; Transport - UDP with NAT traversal
; -----------------------------------------------------------------------------
[transport-udp]
type=transport
protocol=udp
bind=0.0.0.0:${SIP_PORT}
external_media_address=${PUBLIC_IP}
external_signaling_address=${PUBLIC_IP}
; Apply ACL to reject traffic from non-DIDWW sources
acl=didww-only

; -----------------------------------------------------------------------------
; DIDWW Authentication (used for outbound INVITE requests)
; -----------------------------------------------------------------------------
[didww_auth]
type=auth
auth_type=userpass
username=${DIDWW_USERNAME}
password=${DIDWW_PASSWORD}

; -----------------------------------------------------------------------------
; DIDWW Address of Record (AOR)
; -----------------------------------------------------------------------------
[didww_aor]
type=aor
contact=sip:${DIDWW_SIP_HOST}:5060
qualify_frequency=60

; -----------------------------------------------------------------------------
; DIDWW Endpoint
; -----------------------------------------------------------------------------
[didww]
type=endpoint
context=from-internal
disallow=all
allow=ulaw
allow=alaw
allow=g729
allow=gsm
dtmf_mode=rfc4733
outbound_auth=didww_auth
aors=didww_aor
direct_media=no
rtp_symmetric=yes
force_rport=yes
rewrite_contact=yes
ice_support=no
send_rpid=yes
send_pai=yes
; Caller ID settings
; NOTE: Dynamic caller ID is set per-call via ARI channel variables and PJSIP headers.
; Do NOT set from_user here as it would override the per-call caller ID.
; The P-Asserted-Identity header is added dynamically in originateOtpCall().
trust_id_outbound=yes
from_domain=${DIDWW_SIP_HOST}

; -----------------------------------------------------------------------------
; DIDWW Identify (match incoming by hostname)
; -----------------------------------------------------------------------------
[didww_identify]
type=identify
endpoint=didww
match=${DIDWW_SIP_HOST}

; -----------------------------------------------------------------------------
; Internal context for outbound calls
; -----------------------------------------------------------------------------
; Note: Call flow is handled via ARI Stasis, not dialplan
; This context exists as a fallback/placeholder
